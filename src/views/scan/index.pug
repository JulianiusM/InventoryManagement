extends ../layout

block meta
    title Scan | Inventory Management

block content
    - const items = (data && data.items) ? data.items : []

    #liveAlerts

    .d-flex.justify-content-between.align-items-center.mb-3
        h1.h3.mb-0.text-white
            i.bi.bi-upc-scan.me-2
            | Barcode Scanner

    //- Instructions card
    .alert.alert-info.d-flex.align-items-start.mb-3
        i.bi.bi-info-circle.fs-4.me-3
        div
            p.mb-1 Scan a barcode to:
            ul.mb-0.ps-3
                li Find an existing item instantly
                li Navigate to a location using its QR code
                li Create a new item if the code is unknown

    .row.g-3
        //- Camera scanner
        .col-lg-7
            .card.text-bg-dark.border-secondary
                .card-header
                    h2.h5.mb-0
                        i.bi.bi-camera-video.me-2
                        | Camera Scanner
                .card-body
                    //- Camera viewport
                    .position-relative.mb-3
                        video#scanVideo.w-100.rounded(style="max-height: 360px; background: #111; object-fit: cover" playsinline)
                        //- Scanning overlay
                        #scanOverlay.position-absolute.top-0.start-0.w-100.h-100.d-none
                            .position-absolute.top-50.start-50.translate-middle
                                .spinner-border.text-primary(role="status")
                                    span.visually-hidden Loading...
                    
                    //- Status message area
                    #scanStatus.mb-3
                        .alert.alert-secondary.py-2.mb-0
                            i.bi.bi-camera.me-2
                            | Camera not active. Click "Start Scanning" to begin.
                    
                    //- Control buttons
                    .d-flex.gap-2
                        button#scanStart.btn.btn-primary.flex-grow-1(type="button")
                            i.bi.bi-play-fill.me-1
                            | Start Scanning
                        button#scanStop.btn.btn-outline-light.flex-grow-1(type="button" disabled)
                            i.bi.bi-stop-fill.me-1
                            | Stop
                    
                    //- Scanner hints
                    .mt-3
                        h6.text-white-50.small.mb-2
                            i.bi.bi-lightbulb.me-1
                            | Tips for better scanning:
                        ul.text-white-50.small.mb-0
                            li Ensure good lighting
                            li Hold the barcode steady and centered
                            li Avoid glare on shiny surfaces
                            li EAN, UPC, QR, and Code128 are supported

        //- Manual entry & result
        .col-lg-5
            //- Manual entry
            .card.text-bg-dark.border-secondary.mb-3
                .card-header
                    h2.h5.mb-0
                        i.bi.bi-keyboard.me-2
                        | Manual Entry
                .card-body
                    form#manualForm
                        .input-group
                            input#manualCode.form-control.text-bg-dark.form-control-lg(type="text" placeholder="Enter barcode or QR code" autocomplete="off" autofocus)
                            button.btn.btn-primary(type="submit")
                                i.bi.bi-search.me-1
                                | Lookup
                    .form-text.text-white-50.mt-2
                        i.bi.bi-info-circle.me-1
                        | Enter the code manually if camera scanning doesn't work.
                    #manualMsg.mt-2

            //- Result display
            .card.text-bg-dark.border-secondary
                .card-header
                    h2.h5.mb-0
                        i.bi.bi-search.me-2
                        | Scan Result
                .card-body
                    #scanResult
                        .text-center.py-4
                            i.bi.bi-upc.display-4.text-white-50.mb-3.d-block
                            p.text-white-50.mb-0 Scan a code to see details here.

block scripts

block scripts
    script(type="module" src="/js/scan/index.gen.js")
